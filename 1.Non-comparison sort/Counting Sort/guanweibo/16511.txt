#include<stdio.h>
int A(int *x,int *y,int v,int *b)
{
	int p;
	p=*y;
	*y=b[v]-b[v-1]-*x-1;
	*x=p-b[v-1]-1;
	
}
int B(int *x,int *y,int v,int *b)
{
	*x=b[v]-*x+b[v-1]; 
	*y=b[v-1]-*y-1;
}
int C(int *x,int *y,int v,int *b)
{
	int p;
	p=*y;
	*y=*x-b[v-1];
	*x=b[v]-p-1;
}
int main()
{
	int n,i,j,x,y,v;
	int c=0;
	char z;
	char a[99][99];
	int b[30]={0};
	while(scanf("%d",&n)&&n!=0)
	{
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
			{
				scanf("%c",&a[i][j]);
				if(a[i][j]==' ')
				{
					j--;
				}
				if(a[i][j]=='\n')
				{
					j--;
				}
			}
		}
		scanf("%d",&v);
		b[0]=n;
		for(i=1;i<=v;i++)
		{
			b[i]=2*b[i-1];
		}
		scanf("%d%d",&x,&y);
		for(j=v;;j--)
		{
			if(x<n&&y<n)
			{
				break;
			}
			if(x<=b[j-1]-1&&y>b[j-1]-1)
			{ 
				A(&x,&y,v,b);
				printf("A x=%d   y=%d    j=%d   b[v]=%d \n",x,y,j,b[v]); 
			}
			else if(x>b[j-1]-1&&y<=b[j-1]-1)
			{ 
				B(&x,&y,v,b);
				printf("B x=%d   y=%d    j=%d   b[v]=%d \n",x,y,j,b[v]); 
			}
			else if(x>b[j-1]-1&&y>b[j-1]-1)
			{ 
				C(&x,&y,v,b);
				printf("C x=%d   y=%d    j=%d   b[v]=%d \n",x,y,j,b[v]); 
			}
			else
			{ 
				
				printf("D x=%d   y=%d    j=%d   b[v]=%d \n",x,y,j,b[v]); 
			}
			v--;
		}
		z=a[x-1][y-1];
		c++;
		printf("Case %d : %c\n",c,a[x][y]); 
	}
	return 0;
} 